<!DOCTYPE html>
<html lang="pl">
<head>
  <link rel="icon" type="image/png" href="logo.png">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kalkulator.Naleśnik</title>
  <meta name="description" content="Kalkulator online Kalkulator.Naleśnik – prosty i nowoczesny kalkulator w przeglądarce. Dodawanie, odejmowanie, mnożenie, dzielenie i procenty.">
  <style>
    :root{
      --bg:#0f1724; --panel:#0b1220; --accent:#7c3aed; --muted:#94a3b8;
      --btn:#111827; --btn-hover:#1e293b; --glass: rgba(255,255,255,0.03);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh;
      display:flex; flex-direction:column; align-items:center; justify-content:flex-start;
      background:linear-gradient(180deg,#071024 0%, #081129 100%);
      color:#e6eef8;
      font-size:16px;
      padding:30px 10px;
    }
    h1{
      font-size:28px;
      margin-bottom:8px;
      text-align:center;
    }
    p{
      color:var(--muted);
      text-align:center;
      margin-bottom:20px;
    }
    .calculator{
      width:360px; max-width:95vw;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:16px; padding:18px; box-shadow: 0 8px 30px rgba(2,6,23,0.7);
      border: 1px solid rgba(255,255,255,0.03);
    }
    .display{
      background:var(--panel); padding:14px; border-radius:10px;
      min-height:72px; display:flex; flex-direction:column; justify-content:center;
      margin-bottom:12px; position:relative;
    }
    .history{
      color:var(--muted); font-size:13px; opacity:0.9; word-break:break-all;
    }
    .result{
      font-size:28px; font-weight:600; text-align:right; word-break:break-all;
    }
    .grid{
      display:grid; grid-template-columns: repeat(4,1fr); gap:10px;
    }
    button{
      background:var(--btn); border:0; padding:16px; border-radius:10px;
      color:inherit; font-size:18px; cursor:pointer; box-shadow: 0 2px 0 rgba(0,0,0,0.25);
      user-select:none;
    }
    button:active{ transform: translateY(1px) }
    .op{ background:linear-gradient(180deg,var(--btn-hover),var(--btn)); }
    .accent{ background: linear-gradient(180deg,var(--accent), #5b21b6); color:white; font-weight:600; }
    .wide{ grid-column: span 2; }
    .small{ padding:12px; font-size:16px; }
    .muted{ background:transparent; color:var(--muted); border:1px solid rgba(255,255,255,0.03) }
    @media (max-width:420px){
      .calculator{ width:320px }
      .result{ font-size:24px }
    }
  </style>
</head>
<body>
  <h1>Witaj na stronie Kalkulator.Naleśnik!</h1>
  <p>Tu możesz szybko i łatwo wykonywać obliczenia online.</p>

  <div class="calculator" role="application" aria-label="Kalkulator">
    <div class="display" aria-live="polite">
      <div class="history" id="history">&nbsp;</div>
      <div class="result" id="result">0</div>
    </div>

    <div class="grid" id="keys">
      <button class="muted small" data-action="clear" title="C - wyczyść">C</button>
      <button class="muted small" data-action="back" title="← - usuń ostatni znak">←</button>
      <button class="muted small" data-value="%" title="procent">%</button>
      <button class="op" data-value="/" title="dzielenie">÷</button>

      <button data-value="7">7</button>
      <button data-value="8">8</button>
      <button data-value="9">9</button>
      <button class="op" data-value="*" title="mnożenie">×</button>

      <button data-value="4">4</button>
      <button data-value="5">5</button>
      <button data-value="6">6</button>
      <button class="op" data-value="-" title="odejmowanie">−</button>

      <button data-value="1">1</button>
      <button data-value="2">2</button>
      <button data-value="3">3</button>
      <button class="op" data-value="+" title="dodawanie">+</button>

      <button data-value="0" class="wide">0</button>
      <button data-value="." title="przecinek">,</button>
      <button class="accent" data-action="equals" title="Enter">=</button>
    </div>
  </div>

  <script>
    (function(){
      const historyEl = document.getElementById('history');
      const resultEl = document.getElementById('result');
      const keys = document.getElementById('keys');

      let expr = '';

      function updateDisplay(){
        historyEl.textContent = expr || '\u00A0';
        resultEl.textContent = expr ? expr.replace(/\*/g, '×').replace(/\//g,'÷') : '0';
      }

      function isValidExpression(s){
        if(!s) return true;
        if(!/^[0-9+\-*/().%\s]*$/.test(s)) return false;
        if(/[\+\*\/%]{2,}/.test(s)) return false;
        if(/\([\+\*\/%]/.test(s)) return false;
        let bal = 0;
        for(let ch of s){
          if(ch === '(') bal++;
          if(ch === ')') bal--;
          if(bal < 0) return false;
        }
        return bal === 0;
      }

      function safeEval(s){
        s = s.replace(/,/g, '.').trim();
        if(!isValidExpression(s)) throw new Error('Nieprawidłowe wyrażenie');
        s = s.replace(/(\d+(\.\d+)?)%/g, '($1/100)');
        if(!/^[0-9+\-*/().\s]*$/.test(s)) throw new Error('Nieprawidłowe wyrażenie');
        const fn = new Function('return ' + s);
        const value = fn();
        if(!isFinite(value)) throw new Error('Wynik nie jest skończony');
        return value;
      }

      keys.addEventListener('click', (e) => {
        const btn = e.target.closest('button');
        if(!btn) return;
        let v = btn.dataset.value;
        const action = btn.dataset.action;

        if(action === 'clear'){ expr = ''; updateDisplay(); return; }
        if(action === 'back'){ expr = expr.slice(0, -1); updateDisplay(); return; }
        if(action === 'equals'){
          try{
            const val = safeEval(expr);
            expr = String(Number.isInteger(val) ? val : parseFloat(val.toFixed(10)));
            updateDisplay();
          }catch(err){ resultEl.textContent = 'Błąd'; }
          return;
        }

        if(v){
          if(v === ',') v = '.';
          const last = expr.slice(-1);
          if(/[+\-*/%]/.test(v)){
            if(expr === '' && v !== '-') return;
            if(/[+\-*/%]/.test(last)) expr = expr.slice(0,-1) + v;
            else expr += v;
          } else {
            expr += v;
          }
          updateDisplay();
        }
      });

      window.addEventListener('keydown', (e) => {
        const key = e.key;
        if(/^[0-9]$/.test(key)){ expr += key; updateDisplay(); e.preventDefault(); return; }
        if(key === ',' || key === '.'){ expr += '.'; updateDisplay(); e.preventDefault(); return; }
        if(['+','-','*','/'].includes(key)){
          const last = expr.slice(-1);
          if(expr === '' && key !== '-') return;
          if(/[+\-*/%]/.test(last)) expr = expr.slice(0,-1) + key;
          else expr += key;
          updateDisplay(); e.preventDefault(); return;
        }
        if(key === 'Enter' || key === '='){
          try{
            const val = safeEval(expr);
            expr = String(Number.isInteger(val) ? val : parseFloat(val.toFixed(10)));
            updateDisplay();
          }catch(err){ resultEl.textContent = 'Błąd'; }
          e.preventDefault(); return;
        }
        if(key === 'Backspace'){ expr = expr.slice(0,-1); updateDisplay(); e.preventDefault(); return; }
        if(key.toLowerCase() === 'c' && (e.ctrlKey || e.metaKey)){ expr = ''; updateDisplay(); e.preventDefault(); return; }
        if(key === '%'){ expr += '%'; updateDisplay(); e.preventDefault(); }
      });

      updateDisplay();
    })();
  </script>
</body>
</html>



